<!DOCTYPE html5>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.7.9/fabric.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="./static/js/NetGraph.js"></script>
    <script src="./static/js/Tools.js"></script>
    <script src="./static/js/Params.js"></script>
    <script src="./static/js/TextOutput.js"></script>
  </head>
  <style>
    .canvas-container 
    {
    margin:0 auto ;
    }
  </style>
  <body style="display:flex;margin:0;height:850px;padding:10px;">
    
    <div style="background-color:grey;flex:1 0 auto;">
      <h1>Instruments</h1>
    </div>

    <div style="flex:8 0 auto;margin:0 10px;display:flex; flex-direction:column;">
      <div style="flex:1 0 auto;">
	<canvas id="c"  style="border:1px solid #ccc;"></canvas>
      </div>
      <div style="flex:9 0 auto;">
	<h1>Status pannel</h1>
      </div>
    </div>

    <div style="background-color:grey;flex:1 0 auto;">
      <h1>Configuration</h1>
    </div>

    <script>
      var canvas = new fabric.Canvas('c', { selection: false });
      canvas.setWidth(800);
      canvas.setHeight(600);
      canvas.on('mouse:down', function(e){
	if(! e.target){
	  pingId = "";
	  delId = "";
	}
      });


      //For tests
      var flag1 = 1;
      var flag2 = 1;
      
      addNode(100,200,"S1",1);
      addNode(100,400,"S2",1);
      addNode(400,200,"H1",2);
      addNode(400,400,"H2",2);
      addNode(650,350,"R1",3);

      canvas.renderAll();

      //Test on adding line between nods      
      var myrect = new fabric.Rect({
      left: 100,
      top: 100,
      fill: 'red',
      width: 20,
      height: 20,
      myName: "MR1"
      });
      myrect.on('mousedown', function(e){
      if(flag1 == 1 && flag2 == 1)
      {
      addLink("S1","H1");
      addLink("S1","H2");
      addLink("S1","S2");
      addLink("S2","H1");
      addLink("S2","H2");
      addLink("H1","H2");
      addLink("R1","S1");
      addLink("R1","S2");
      addLink("R1","H1");
      addLink("R1","H2");

      flag1 = 0;
      flag2 = 0;
      }
      });
      myrect.hasControls = false;
      myrect.hasBorders = false;
      canvas.add(myrect);

      //Test load JSON    
      var myrect2 = new fabric.Rect({
      left: 200,
      top: 100,
      fill: 'red',
      width: 20,
      height: 20,
      myName: "MR2"
      });
      myrect2.on('mousedown', function(e){
      loadTopology();
      });
      myrect2.hasControls = false;
      myrect2.hasBorders = false;
      canvas.add(myrect2);


     </script>
  </body>
</html>
